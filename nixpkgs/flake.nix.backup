{
  description = "desmond's darwin systems configuration";

  inputs = {
    nixpkgs.url = "github:nixos/nixpkgs";
    darwin.url = "/Users/dez/.dotfiles/nixpkgs/";
    darwin.inputs.nixpkgs.follows = "nixpkgs";
    home.url = "github:nix-community/home-manager";
    home.inputs.nixpkgs.follows = "nixpkgs";
    emacs-overlay.url = "github:nix-community/emacs-overlay";
    rnix-lsp.url = "github:nix-community/rnix-lsp";
    rnix-lsp.inputs.nixpkgs.follows = "nixpkgs";
    spacebar.url = "github:cmacrae/spacebar";
  };

  outputs = { self, nixpkgs, darwin, home, emacs-overlay, rnix-lsp, spacebar }: {
    darwinConfigurations.macbook = darwin.lib.darwinSystem {
      modules = [
        ./darwin/macintosh.nix
        home.darwinModules.home-manager

        {
          nixpkgs.overlays = [
            emacs-overlay.overlay
            spacebar.overlay
          ];
        }

        # (
        #   { pkgs, config, ... }: {
        #     networking.hostName = "desmonds-mbp";

        #     nix.distributedBuilds = true;
        #     nix.buildMachines =
        #       pkgs.lib.forEach (pkgs.lib.range 1 3) (
        #         n:
        #         {
        #           hostName = "compute${builtins.toString n}";
        #           sshUser = "root";
        #           sshKey = "${config.users.users.dez.home}/.ssh/id_rsa";
        #           systems = [ "aarch64-linux" "x86_64-linux" ];
        #           maxJobs = 16;
        #         }
        #       );
        #   }
        # )
      ];
    };
  };
}
